- hosts: haproxy
  gather_facts: no
  roles:
    - haproxy
    - keepalive
    - bind
    - bird
  tags: [ LB, HA, BGP, DNS ]

- hosts: all
  gather_facts: no
  roles:
    - firewall
    - common
    - node_explorer
  tags: [ ]

- hosts: controlplane
  gather_facts: no
  roles:
    - ca
  tags: [ CA ]

- hosts: etcd
  gather_facts: no
  roles:
    - crt
    - containerd
    - kubelet
    - kube-proxy
    - calico
    # - etcd
    - etcd_pod
  tags: [ ETCD ]

- hosts: monit
  gather_facts: no
  roles:
    - crt
    - prometheus
    - grafana
    - nginx
  tags: [ PROMETHEUS ]

- hosts: exabgp
  gather_facts: no
  roles:
    - exabgp
  tags: [ EXABGP ]

- hosts: controlplane
  gather_facts: no
  roles:
    - crt
    - containerd
    - kubelet
    - kube-apiserver_pod
    - kube-scheduler
    - kube-controller-manager
    - cloud-controller-manager
  tags: [ CP ]

- hosts: controlplane
  gather_facts: no
  roles:
    - cluster_init
  tags: [ INIT ]

- hosts: worker
  gather_facts: no
  roles:
    - crt
    - containerd
    - kubelet
    - kube-proxy
    - calico
  tags: [ WORKER ]

- hosts: controlplane
  gather_facts: no
  roles:
    - cluster_post
  tags: [ POST ]
